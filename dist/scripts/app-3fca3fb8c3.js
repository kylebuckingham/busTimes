!function(){"use strict";angular.module("frontend",["ngAnimate","ngCookies","ngTouch","ngSanitize","ngMessages","ngAria","ngResource","ngRoute","ui.bootstrap","ngMap","angularjs-dropdown-multiselect"])}(),function(){"use strict";function t(t,e,n,i,a,o){return{getData:function(i){var a=e.defer(),o="https://3zstizfpne.execute-api.us-west-2.amazonaws.com/prod/records?start="+i.start+"&end="+i.end;return t.get(o).then(function(t){a.resolve(t)})["catch"](function(t){n.error(t),a.resolve(null)}),a.promise}}}t.$inject=["$http","$q","$log","$timeout","$location","$rootScope"],angular.module("frontend").service("dataService",t)}(),function(){"use strict";function t(t,e,n){function i(){t.loading=!0,e.getData(t.times).then(function(e){t.loading=!1,t.data=e.data;for(var n in t.data)-1===t.routesIds.indexOf(t.data[n].routeid)&&t.routesIds.push(t.data[n].routeid);t.routes=[];for(var i in t.routesIds)t.routes.push({id:t.routesIds[i],label:t.routesIds[i]});a()})}function a(){t.mapData=[];for(var e in t.data){var n=parseInt(t.data[e].stopdeviationinseconds);if(t.lateness<n/60)for(var i in t.selectedRoutes)t.selectedRoutes[i].id===t.data[e].routeid&&t.mapData.push({location:new google.maps.LatLng(t.data[e].lat,t.data[e].lon),weight:n/60,lat:t.data[e].lat,lon:t.data[e].lon,id:t.data[e].routeid})}o.ready=!0}var o=this;t.mapData=[],t.possibleTimes=["12 am","1 am","2 am","3 am","4 am","5 am","6 am","7 am","8 am","9 am","10 am","11 am","12 pm","1 pm","2 pm","3 pm","4 pm","5 pm","6 pm","7 pm","8 pm","9 pm","10 pm","11 pm"],t.times={start:"6 am",end:"9 am"},t.lateness=0,t.$on("mapInitialized",function(e,n){t.busTimesMap=n}),t.selectedRoutes=[],t.routes=[],t.routesIds=[],t.mOptions={enableSearch:!0,scrollable:!0,scrollableHeight:"500px"},t.mTexts={buttonDefaultText:"Select Route(s)"},t.$watch("selectedRoutes",function(t,e){t!==e&&a()},!0),t.$watch("times",function(e,n){if(e!==n){var a=parseInt(t.times.start.match(/\d+/)),o=parseInt(t.times.end.match(/\d+/));-1!=t.times.start.indexOf("pm")&&(a+=12),-1!=t.times.end.indexOf("pm")&&(o+=12),a>o?t.badTime=!0:(t.badTime=!1,i())}},!0),t.$watch("lateness",function(t,e){t!==e&&a()}),t.showInfoWindow=function(e,n){var i=new google.maps.InfoWindow,a=new google.maps.LatLng(n.lat,n.lon);i.setContent("<div><span><b>Route:  </b>"+n.id+"</span><br/><span><b>Late(median):</b>  "+60*n.weight+" sec</span><br/><span><b>Lat/Lon:</b>  "+n.lat+" "+n.lon+"</span><br/></div>"),i.setPosition(a),i.open(t.busTimesMap)},i()}t.$inject=["$scope","dataService","NgMap"],angular.module("frontend").controller("MainController",t)}(),function(){"use strict";angular.module("customFilters",[]).filter("mn",function(){return function(t){return Number(t.substring(0,t.length-2))}}).filter("sizer",function(){return function(t){var e,n=0;for(e in t)t.hasOwnProperty(e)&&n++;return n}}).filter("getType",function(){return function(t){return t?-1!==t.indexOf("ShardMapRDD")?"Shard Map":-1!==t.indexOf("MapRDD")?"Map":-1!==t.indexOf("ShardReduceRDD")?"Shard Reduce":-1!==t.indexOf("FilterRDD")?"Filter":-1!==t.indexOf("SliceRDD")?"SliceRDD":void 0:"Idle"}}).filter("getDate",function(){return function(t){return new Date(t).toString()}}).filter("bytesToMB",function(){return function(t){return parseFloat(t/1024/1024).toFixed(2)}}).filter("encode",function(){return function(t){return encodeURIComponent(t)}}).filter("shortenStr",function(){return function(t,e){return t.substring(0,e)+"..."}}).filter("isDuplicate",function(){return function(t,e){var n;for(n in t)if(t[n].id===e)return!0;return!1}}).filter("millisToTime",function(){return function(t){var e={d:864e5,h:36e5,m:6e4,s:1e3,ms:1},n="";for(var i in e)if(t/e[i]>=1){var a=Math.floor(t/e[i]);t-=a*e[i],n+=a+i+" "}return n}}).filter("toArray",function(){return function(t,e){return e===!1?Object.keys(t).map(function(e){return t[e]}):Object.keys(t).map(function(e){return"object"==typeof t[e]?Object.defineProperty(t[e],"$key",{enumerable:!1,value:e}):void 0})}}).filter("alphaNum",function(){return function(t){return t.replace(/\W/g,"")}}).filter("secondsToTimeString",function(){return function(t){return"0"===t?"All Time":"60"===t?"1 min":"600"===t?"10 min":"3600"===t?"1 hour":void 0}}).filter("unique",function(){return function(t,e){return _.uniq(t,function(t){return t[e]})}})}(),function(){"use strict";function t(t){t.debug("runBlock end")}t.$inject=["$log"],angular.module("frontend").run(t)}(),function(){"use strict";function t(t){t.when("/",{templateUrl:"app/main/main.html",controller:"MainController",controllerAs:"vm"}).otherwise({redirectTo:"/"})}t.$inject=["$routeProvider"],angular.module("frontend").config(t)}(),function(){"use strict";angular.module("frontend")}(),function(){"use strict";function t(t){t.debugEnabled(!0)}t.$inject=["$logProvider"],angular.module("frontend").config(t)}(),angular.module("frontend").run(["$templateCache",function(t){t.put("app/main/main.html",'<div class="container"><div class="cssload-dots" ng-if="loading"><div class="cssload-dot"></div><div class="cssload-dot"></div><div class="cssload-dot"></div><div class="cssload-dot"></div><div class="cssload-dot"></div></div><svg version="1.1" xmlns="http://www.w3.org/2000/svg"><defs><filter id="goo"><fegaussianblur in="SourceGraphic" result="blur" stddeviation="12"></fegaussianblur><fecolormatrix in="blur" mode="matrix" values="1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 18 -7" result="goo"></fecolormatrix></filter></defs></svg><map zoom="11" id="map" center="[47.609722,-122.333056]" ng-if="vm.ready"><marker ng-if="marks === true && mapData" ng-repeat="pos in mapData" position="{{pos.lat}},{{pos.lon}}" on-click="showInfoWindow(event, pos)"></marker><heatmap-layer ng-if="heat === true && mapData" data="mapData" id="foo"></heatmap-layer></map><div class="controls"><div class="choseTime"><select name="start" ng-options="time for time in possibleTimes" ng-model="times.start"></select>to<select name="end" ng-options="time for time in possibleTimes" ng-model="times.end"></select><div><span ng-if="badTime">Start must become before end</span></div></div><div><span>Lateness (min)</span> <input type="number" id="lateness" name="quantity" min="0" ng-model="lateness"></div><div ng-dropdown-multiselect="" options="routes" selected-model="selectedRoutes" extra-settings="mOptions" translation-texts="mTexts"></div><div><button type="button" class="btn btn-primary" ng-click="marks = !marks">Markers</button> <button type="button" class="btn btn-primary" ng-click="heat = !heat">HeatMap</button></div></div></div>')}]);
//# sourceMappingURL=../maps/scripts/app-3fca3fb8c3.js.map
